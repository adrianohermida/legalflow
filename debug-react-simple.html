<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug React - LegalFlow</title>
    <style>
        body {
            font-family: system-ui;
            padding: 20px;
            background: #f5f5f5;
        }
        .debug-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid;
        }
        .status.success { background: #e8f5e8; border-color: #4caf50; }
        .status.error { background: #ffebee; border-color: #f44336; }
        .status.info { background: #e3f2fd; border-color: #2196f3; }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>üîç Debug React Loading Issue</h1>
        
        <div id="react-status" class="status info">
            <h3>‚öõÔ∏è Testing React</h3>
            <p>Checking if React can load...</p>
        </div>

        <div id="dom-status" class="status info">
            <h3>üèóÔ∏è DOM Status</h3>
            <p>Checking DOM structure...</p>
        </div>

        <div id="app-status" class="status info">
            <h3>üì± App Status</h3>
            <p>Checking if main app loads...</p>
        </div>

        <div class="status">
            <h3>üìù Console Logs</h3>
            <pre id="console-output">Waiting for logs...</pre>
        </div>

        <div class="status">
            <h3>üîó Test Links</h3>
            <p><a href="/" target="_blank">üè† Main App</a></p>
            <p><a href="/client/App.tsx" target="_blank">üìÑ App.tsx Direct</a></p>
        </div>
    </div>

    <script>
        const reactStatus = document.getElementById('react-status');
        const domStatus = document.getElementById('dom-status');
        const appStatus = document.getElementById('app-status');
        const consoleOutput = document.getElementById('console-output');
        
        let logs = [];
        
        // Capture console logs
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addLog(type, ...args) {
            const timestamp = new Date().toLocaleTimeString();
            const message = `[${timestamp}] [${type.toUpperCase()}] ${args.join(' ')}`;
            logs.push(message);
            consoleOutput.textContent = logs.slice(-10).join('\n');
            
            if (type === 'log') originalLog(...args);
            if (type === 'error') originalError(...args);
            if (type === 'warn') originalWarn(...args);
        }
        
        console.log = (...args) => addLog('log', ...args);
        console.error = (...args) => addLog('error', ...args);
        console.warn = (...args) => addLog('warn', ...args);
        
        console.log('üöÄ Debug started');
        
        // Test React loading
        function testReact() {
            try {
                // Try to load React
                const script = document.createElement('script');
                script.type = 'module';
                script.textContent = `
                    import React from 'https://esm.sh/react@18';
                    import { createRoot } from 'https://esm.sh/react-dom@18/client';
                    
                    console.log('‚úÖ React loaded successfully');
                    
                    const testRoot = document.getElementById('react-test');
                    if (testRoot) {
                        const root = createRoot(testRoot);
                        root.render(React.createElement('div', {
                            style: { color: 'green', fontWeight: 'bold' }
                        }, '‚úÖ React is working!'));
                    }
                `;
                document.head.appendChild(script);
                
                reactStatus.className = 'status success';
                reactStatus.innerHTML = `
                    <h3>‚úÖ React Test</h3>
                    <p>React loading test initiated</p>
                    <div id="react-test" style="margin-top: 10px;"></div>
                `;
                
            } catch (error) {
                console.error('‚ùå React test failed:', error);
                reactStatus.className = 'status error';
                reactStatus.innerHTML = `
                    <h3>‚ùå React Test Failed</h3>
                    <p>Error: ${error.message}</p>
                `;
            }
        }
        
        // Check DOM
        function checkDOM() {
            const mainRoot = document.getElementById('root');
            const bodyContent = document.body.innerHTML.length;
            
            domStatus.innerHTML = `
                <h3>üèóÔ∏è DOM Status</h3>
                <p>Body content size: ${bodyContent} chars</p>
                <p>Main #root exists: ${mainRoot ? '‚úÖ Yes' : '‚ùå No'}</p>
                <p>Current URL: ${window.location.href}</p>
            `;
            
            if (bodyContent > 1000) {
                domStatus.className = 'status success';
            }
        }
        
        // Test main app
        async function testMainApp() {
            try {
                const response = await fetch('/');
                const html = await response.text();
                
                if (html.includes('LegalFlow') && html.includes('root')) {
                    appStatus.className = 'status success';
                    appStatus.innerHTML = `
                        <h3>‚úÖ Main App Accessible</h3>
                        <p>Main app responds correctly (${html.length} chars)</p>
                        <p>Contains root element: ${html.includes('id="root"') ? '‚úÖ' : '‚ùå'}</p>
                    `;
                } else {
                    appStatus.className = 'status error';
                    appStatus.innerHTML = `
                        <h3>‚ùå Main App Issues</h3>
                        <p>Response size: ${html.length} chars</p>
                        <p>Missing expected content</p>
                    `;
                }
            } catch (error) {
                console.error('‚ùå Main app test failed:', error);
                appStatus.className = 'status error';
                appStatus.innerHTML = `
                    <h3>‚ùå Main App Error</h3>
                    <p>Error: ${error.message}</p>
                `;
            }
        }
        
        // Run tests
        setTimeout(testReact, 500);
        setTimeout(checkDOM, 1000);
        setTimeout(testMainApp, 1500);
        
        console.log('‚úÖ Debug tests initiated');
    </script>
</body>
</html>
