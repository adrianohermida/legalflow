<!DOCTYPE html>
<html>
<head>
    <title>Component Debug - LegalFlow</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        .debug { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .error { background: #f8d7da; }
        .success { background: #d4edda; }
        .warning { background: #fff3cd; }
        .info { background: #d1ecf1; }
    </style>
</head>
<body>
    <h1>üîç Component Debug - LegalFlow</h1>
    <div id="debug-info"></div>
    <div id="react-root"></div>

    <script type="module">
        const debugInfo = document.getElementById('debug-info');
        
        function addDebug(type, title, message, details) {
            const div = document.createElement('div');
            div.className = `debug ${type}`;
            div.innerHTML = `
                <h3>${title}</h3>
                <p>${message}</p>
                ${details ? `<pre>${details}</pre>` : ''}
            `;
            debugInfo.appendChild(div);
        }

        // Test 1: Environment Check
        addDebug('info', '1. Environment Check', 
            `URL: ${window.location.href}<br>User Agent: ${navigator.userAgent.slice(0, 60)}...`);

        // Test 2: Try loading React component
        try {
            addDebug('info', '2. Loading React Module', 'Attempting to load /client/App.tsx...');
            
            import('/client/App.tsx')
                .then(module => {
                    addDebug('success', '2. React Module Loaded', 
                        `Module loaded successfully. Exports: ${Object.keys(module).join(', ')}`);
                    
                    // Try to render the component
                    if (module.default) {
                        addDebug('success', '3. Component Found', 'Default export found, attempting render...');
                        
                        // Check if this is the problematic component
                        const componentStr = module.default.toString();
                        if (componentStr.includes('return <></>') || componentStr.includes('return <>')) {
                            addDebug('error', 'üêõ BUG FOUND', 
                                'Component returns empty fragment!', 
                                componentStr.slice(0, 200) + '...');
                        }
                    } else {
                        addDebug('warning', '3. No Default Export', 'Module has no default export');
                    }
                })
                .catch(error => {
                    addDebug('error', '2. Module Load Error', 
                        `Failed to load React module: ${error.message}`, 
                        error.stack);
                });
        } catch (error) {
            addDebug('error', '2. Import Error', 
                `Import failed: ${error.message}`, 
                error.stack);
        }

        // Test 3: API Status
        fetch('/api/health')
            .then(response => response.json())
            .then(data => {
                addDebug('success', '4. API Status', 
                    `API is working: ${data.message}`, 
                    JSON.stringify(data, null, 2));
            })
            .catch(error => {
                addDebug('error', '4. API Error', 
                    `API failed: ${error.message}`);
            });

        // Test 4: Console monitoring
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;
        
        console.error = function(...args) {
            addDebug('error', '5. Console Error', 
                `JavaScript error detected: ${args.join(' ')}`);
            originalConsoleError.apply(console, args);
        };
        
        console.warn = function(...args) {
            addDebug('warning', '5. Console Warning', 
                `JavaScript warning: ${args.join(' ')}`);
            originalConsoleWarn.apply(console, args);
        };
    </script>
</body>
</html>
